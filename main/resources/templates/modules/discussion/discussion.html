<meta http-equiv="Content-Type" charset="utf-8" xmlns:th="http://www.w3.org/1999/xhtml"/>
<script th:src="@{/js/jquery-2.0.3.min.js}"></script>
<script th:src="@{/js/2018/jquery-1.11.3.min.js}"></script>
<link th:href="@{/css/2018/style.css}" rel="stylesheet" />
<script type="text/javascript" th:src="@{/at/js/jquery.caret.js}"></script>
<script type="text/javascript" th:src="@{/at/js/jquery.atwho.js}"></script>
<script type="text/javascript" th:src="@{/ckeditor/ckeditor.js}"></script>
<link th:href="@{/js/layui/css/layui.css}"  rel="stylesheet"/>
<link th:href="@{/js/layui/css/eleTree.css}"  rel="stylesheet"/>
<script th:src="@{/js/layui/layui.js}"></script>
<link th:href="@{/at/css/jquery.atwho.css}" rel="stylesheet" />
<link th:href="@{/css/aaa.css}" rel="stylesheet" />
<script th:src="@{/js/discussion.js}"></script>
<script th:src="@{/js/log.js}"></script>
<script th:src="@{/js/dev.js}"></script>
<script th:src="@{/js/pageinfo.js}"></script>
<script th:src="@{/js/2018/jquery.scrollLoading.js}"></script>
<script th:src="@{/js/webuploader-0.1.5/webuploader.js}"></script>
<script th:src="@{/js/transpond/transpond.js}"></script>
<script th:src="@{/js/groupEdit/groupEdit.js}"></script>

<script th:src="@{/js/groupEdit/mpmEdit.js}"></script>
<script th:src="@{/css/bootstrap-3.0.2/js/bootstrapmenu.min.js}"></script>
<script th:src="@{/css/bootstrap-3.0.2/js/bootstrap.min.js}"></script>
<link th:href="@{/css/bootstrap-3.0.2/css/bootstrap.css}" rel="stylesheet" />
<link th:href="@{/css/bootstrap-3.0.2/css/bootstrap-switch.min.css}" rel="stylesheet"/>
<script th:src="@{/js/report/yanhua.js}"></script>
<link th:href="@{/js/dialog/jquery.gritter.css}" rel="stylesheet" />
<script th:src="@{/js/dialog/jquery.gritter.js}"></script>
<script th:src="@{/js/dialog/bootbox.js}"></script>
<script th:src="@{/js/dialog/dialog.js}"></script>
<script th:src="@{/js/ajax.js}"></script>
<script th:src="@{/js/download.js}"></script>
<script th:src="@{/js/socket.io.js}"></script>
<script th:src="@{/js/chat.js}"></script>
<link th:href="@{/css/font-awesome-4.7.0/css/font-awesome.min.css}" rel="stylesheet" />
<style type="text/css">
	.layui-nav-item{
		/*float: right;*/
	}
</style>
<input type="hidden" id="chat-type" />
<input type="hidden" id="chat-user-id" />
<input type="hidden" id="send_type" />
<input type="hidden" id="at_user" />
<input type="hidden" id="talking_type" />
<ul class="layui-nav">
	<li class="layui-nav-item" style="float: right">
		<a onclick="showHelpDoc()" style="float: right">帮助文档<span class="layui-badge-dot"></span></a>
		<a onclick="showSceneDoc()">11文档<span class="layui-badge-dot"></span></a>
	</li>
	<li class="layui-nav-item" lay-unselect="">
		<img src="/img/logox.png" class="layui-nav-img"/>云雀协同研讨厅
<!--		<a href="javascript:;"><img src="/userHeadController/showHead?isme=2020" class="layui-nav-img"/>我</a>-->
<!--		<dl class="layui-nav-child">-->
<!--			<dd><a onclick="showHelpDoc()">帮助文档</a></dd>-->
<!--			<dd><a onclick="setModeDialog('2')">个人信息</a></dd>-->
<!--&lt;!&ndash;			<dd><a onclick="setModeDialog('1')">帮助文档</a></dd>&ndash;&gt;-->
<!--		</dl>-->
	</li>
</ul>
<div class="body_context">
	<div class="left_context">

		<div class="layui-tab" style="height: 98vh">
			<ul class="layui-tab-title">
				<li onclick="show_lately()">最近</li>
				<li>联系人</li>
				<li onclick="show_group()">群组</li>
			</ul>
			<div class="layui-tab-content" style="height: 80vh">
				<div class="layui-tab-item layui-show" id="nearest_contact">

				</div>
				<div class="layui-tab-item">
					<div>
						<div class="layui-input-block" style="margin: 0px;width: 30vh;">
							<input type="text" placeholder="请输入关键字进行搜索" autocomplete="off" class="layui-input eleTree-search"  id="searchUser"/>
						</div>
<!--						<div>-->
<!--							<i class="layui-icon layui-icon-read" style="font-size: 30px; color: #1E9FFF;margin-left: 30px" onclick="showHelpDoc()">-->
<!--							</i>-->
<!--						</div>-->
					</div>
					<div class="eleTree ele6" lay-filter="userList" style="overflow-y: auto;height: 80vh"></div>
				</div>
				<div class="layui-tab-item" >
					<button onclick="get_create_group()" type="button" class="layui-btn" style="width: 28vh;">
						<i class="layui-icon">&#xe608;</i> 创建群组
					</button>
					<div class="layui-tab-item layui-show" id="group_list" style="margin-top: 15px">

					</div>
				</div>
			</div>
		</div>
<!--		<input class="search_User_group" type="text" id="contacts_kw_" name="contacts_kw_" placeholder="搜索联系人" onchange="query_userlist()"/>-->
<!--		<ul style="margin-top: 7px;">-->
<!--			<li id="nav_00" class="nav_style" onclick="changeContactsNav(this)" style="display: none;">-->
<!--				<img alt="" src="/images/2018/c04.png" />-->
<!--				<span><a>搜索</a></span>-->
<!--			</li>-->
<!--			<ul id="ul_pid_nav_01_1" class="org-dt-ul active" style="overflow-x: hidden; height:calc(100vh - 260px); min-height:calc(100% - 260px);display: none;"></ul>-->
<!--			<li id="nav_01" class="nav_style" onclick="changeContactsNav(this)">-->
<!--				<img alt="" src="/images/2018/c01.png" />-->
<!--				<span><a>联系人</a></span>-->
<!--				<img style="float: right; position: relative; top: 18px; right: 10px;" src="/images/2018/down_0.png" />-->
<!--			</li>-->
<!--			<ul id="ul_pid_nav_01" class="org-dt-ul active" style="overflow-x: hidden;height:calc(100vh - 207px); min-height:calc(100% - 260px);"></ul>-->
<!--			<li id="nav_02" class="nav_style" onclick="changeContactsNav(this)">-->
<!--				<img alt="" src="/images/2018/c02.png" />-->
<!--				<span><a>最近</a></span>-->
<!--				<img style="float: right; position: relative; top: 18px; right: 10px;" src="/images/2018/down_0.png" />-->
<!--			</li>-->
<!--			<ul id="ul_pid_nav_02" class="dt-ul" style="overflow-x: hidden;height:calc(100vh - 207px); min-height:calc(100% - 260px); display: none;"></ul>-->
<!--			<li id="nav_03" class="nav_style" onclick="changeContactsNav(this)">-->
<!--				<img alt="" src="/images/2018/c03.png" />-->
<!--				<span><a>群组</a></span>-->
<!--				<img style="float: right; position: relative; top: 18px; right: 10px;" src="/images/2018/down_0.png" />-->
<!--			</li>-->
<!--			<ul id="ul_pid_nav_03" class="org-dt-ul" style="overflow-x: hidden;height:calc(100vh - 207px); min-height:calc(100% - 260px); display: none;"></ul>-->
<!--		</ul>-->
	</div>
	<div id="middle_context" class="middle_context">
		<div class="right-main-div" id="main-div" style="display: none; width: 99.8%; height:calc(100vh - 2px); ">
			<div id="container-div" style="text-align: center;">
				<div id="load-div" onclick="loadMove()">
					<span class="load-span" onclick="show_himsg(1)"><i
						class="fa fa-list"></i>历史消息</span>
				</div>
				<ul id="isTabShow" style="margin-top: 8px;">
					<li onclick="show_group_info()" id="ginfo" data-toggle="tooltip" title="组信息"><span
						class="glyphicon glyphicon-comment"></span> </li>
					<li onclick="show_group_user()" id="guser" data-toggle="tooltip" title="成员"><span
						class="glyphicon glyphicon-user"></span> </li>
					<li onclick="show_group_file()" id="gfile" data-toggle="tooltip" title="组文件"><span
						class="glyphicon glyphicon-folder-open"></span> </li>
					<li onclick="show_importantInfo_user($('#chat-user-id').val())" id="import" data-toggle="tooltip" title="重要信息">
						<span class="glyphicon glyphicon-asterisk"></span>
					</li>
					<li onclick="out_files()" id="fileout" data-toggle="tooltip" title="导出">
						<span class="glyphicon glyphicon-save"></span>
					</li>
					<li onclick="edit_group($('#chat-user-id').val())" id="fileout" data-toggle="tooltip" title="讨论组编辑">
						<span class="glyphicon glyphicon-pencil"></span>
					</li>
					<li onclick="closed_group($('#chat-user-id').val(), this)" code="modules/discussion/discussion" id="closeGroup" data-toggle="tooltip" title="讨论组关闭">
						<span class="glyphicon glyphicon-remove"></span>
					</li>
				</ul>
				<div id="chat-content" style="margin-top: 30px;height: calc(100vh - 240px); overflow-x: hidden;"></div>
			</div>

			<div id="container_div" class="send-div" >
				<div>
					<div style="" class="img-div" >
						<div
							style="padding: 4px 20px 0px 0px; float: right; color: #666; cursor: pointer; font-size: 12px;"
							onclick="show_himsg(1)">
						</div>
					</div>
					<div id="enterdiv">
						<textarea id="msgcontent" name="msgcontent"></textarea>
					</div>
					<div class="btn-div text-right" style="margin-right:10px;">
						<button id="sendMsgBtn" onclick="sendMsg()" style="float: right; margin-top: 5px;"
								class="btn btn-success">发送</button>
						<div id="bottom_level" style="position: relative; right: 15px; top: 10px; float: right;"></div>
					</div>
				</div>


<!--				<div id="emoji-panel-div" style="overflow-y: auto;">-->
<!--					<div id="emoji-list-div">-->
<!--						<img class="emoji-div"-->
<!--							th:each="item:${#numbers.sequence(701,755)}"-->
<!--							th:src="@{/img/emoji/} + ${item} + '.png'" />-->
<!--					</div>-->
<!--				</div>-->
			</div>
		</div>
	</div>
	<div id="right_context" class="right_context">
		<!-- 个人信息start -->
		<div id="user_info_div" class="user_info_div">
			<div class="row" style="margin-top: 15px;">
				<div style="margin-left: 16px;">
					<div id="talkUserHead" style="margin-top: 30px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 15px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 27%;">
					<i class="fa fa-info-circle" style="color:#B3B7CB; float: left;"></i>
					<div class="uinfoOne">姓名:</div>
					<div class="uinfoTwo" id="userName"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 27%;">
					<i class="fa fa-align-justify" style="color:#B3B7CB; float: left;"></i>
					<div class="uinfoOne">科室:</div>
					<div class="uinfoTwo" id="classRoom"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 27%;">
					<i class="fa fa-calendar" style="color:#B3B7CB; float: left;"></i>
					<div class="uinfoOne">办公地点:</div>
					<div class="uinfoTwo" id="address"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 27%;">
					<i class="fa fa-calendar" style="color:#B3B7CB; float: left;"></i>
					<div class="uinfoOne">人员密级:</div>
					<div class="uinfoTwo" id="levelsinfo"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 27%;">
					<i class="fa fa-calendar" style="color:#B3B7CB; float: left;"></i>
					<div class="uinfoOne">联系电话:</div>
					<div class="uinfoTwo" id="call_phone_"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 27%;">
					<i class="fa fa-calendar" style="color:#B3B7CB; float: left;"></i>
					<div class="uinfoOne">是否在线:</div>
					<div class="uinfoTwo" id="is_online_"></div>
				</div>
			</div>
		</div>
		<!-- 个人信息end -->
		<!-- 讨论组信息 start -->
		<div id="group_info_div" class="right-main-div group_info_div">
			<!-- ajax填充讨论组信息 -->
			<div class="row" style="margin-top: 40px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<i class="fa fa-info-circle" style="color:#B3B7CB;"></i>
					<div class="label_">主题:</div>
					<div class="group_info" id="group_name" style="margin-left: 16px; margin-top: 10px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 30px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<i class="fa fa-info-circle" style="color:#B3B7CB;"></i>
					<div class="label_">密级:</div>
					<div class="group_info" id="group_le" style="margin-left: 16px; margin-top: 10px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 30px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<i class="fa fa-align-justify" style="color:#B3B7CB;"></i>
					<div class="label_">描述:</div>
					<div class="group_info" id="group_describe" style="margin-left: 16px; margin-top: 10px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 30px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<i class="fa fa-calendar" style="color:#B3B7CB;"></i>
					<div class="label_">发起时间:</div>
					<div class="group_info" id="group_create_time" style="margin-left: 16px; margin-top: 10px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 30px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<i class="fa fa-user" style="color:#B3B7CB;"></i>
					<div class="label_">发起人:</div>
					<div class="group_info" id="group_creator" style="margin-left: 16px; margin-top: 10px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 30px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<i class="fa fa-user" style="color:#B3B7CB;"></i>
					<div class="label_">参与范围:</div>
					<div class="group_info" id="group_creator" style="margin-left: 16px; margin-top: 10px;"></div>
				</div>
			</div>
			<div class="row" style="margin-top: 30px;">
				<div class="col-xs-8 col-sm-8 col-md-8" style="margin-left: 7%;">
					<input id="gId" type="hidden" />
					<div>
<!--						<input type="button" class="out_group" value="退出群组" onclick="out_group($('#chat-user-id').val())" />-->
					</div>
				</div>
			</div>

		</div>
		<!-- 讨论组信息 end -->
		<!-- 讨论组成员 start -->
		<div class="right-main-div group_user_div" id="group_user_div">
			<div id="group_user_list" >
				<!-- ajax填充讨论组成员 -->
			</div>
		</div>
		<!-- 讨论组成员 end -->
		<!-- 重要信息 start -->
		<div class="right-main-div important_info_div" id="important_info_div">
			<div id="important_info_list">
				<!-- ajax填充重要信息 -->
			</div>
		</div>
		<!-- 重要信息 end -->
		<!-- 讨论组文件 start -->
		<div class="right-main-div group_file_div" id="group_file_div">
			<div class="input-group" style="max-width: 200px; height: 26px; margin-top: 10px; margin-left: 10px;">
				<input type="text" class="form-control" style="height: 26px; width: 75%;" id="group_file_input" />
				<span class="input-group-btn" onclick="fc_group_file(1)">
					<button class="btn btn-default" style="height: 34px; padding: 2px 9px;">搜索</button>
				</span>
			</div>
			<div id="group_user_file">
				<!-- ajax填充讨论组文件 -->
				<table class="table table-hover">
					<thead>
						<tr>
							<th style="min-width: 40px;">名称</th>
<!-- 									<th>大小</th> -->
<!-- 									<th class="center" style="min-width: 90px;">时间</th> -->
							<th class="center" style="min-width: 40px;">用户</th>
							<th style="min-width: 40px;" class="del_gro_fil center">操作</th>
						</tr>
					</thead>
					<tbody id="file-table">
					</tbody>
				</table>
			</div>
		</div>
		<!-- 项目进展状态 18-03-22  -->
		<div class="right-main-div" id="group_matter_div"
			style="display: none;">
			<div style="float: left;">
				<div class="update-div"
					style="float: left; margin-left: 10px; padding: 2px;">
					<div id="update_btn" onclick="$(this).find('input')[0].click()">
						项目启动 <input type="file" style="display: none;"
							onchange="upload_group_file(this)" multiple="multiple" />
					</div>
				</div>
				<div class="update-div"
					style="float: left; margin-left: 80px; padding: 2px;">
					<div id="update_btn">
						项目进行中 <input type="file" style="display: none;"
							onchange="upload_group_file(this)" multiple="multiple" />
					</div>
				</div>
				<div class="update-div"
					style="float: left; margin-left: 80px; padding: 2px;">
					<div id="update_btn">
						项目关闭 <input type="file" style="display: none;"
							onchange="upload_group_file(this)" multiple="multiple" />
					</div>
				</div>
				<div class="update-div"
					style="float: left; margin-left: 80px; padding: 2px;">
					<div id="update_btn" onclick="$(this).find('input')[0].click()">
						项目导出 <input type="file" style="display: none;"
							onchange="upload_group_file(this)" multiple="multiple" />
					</div>
				</div>
			</div>
			<div id="group_user_file">
				<!-- ajax填充讨论组文件 -->
				<table class="table table-hover">
					<thead>
						<tr>
							<!-- <th>文件名称</th><th>文件大小</th><th class="center" style="min-width:90px;">上传时间</th>
	        				<th class="center" style="min-width:80px;">上传用户</th> -->
							<th class="del_gro_fil"></th>
						</tr>
					</thead>
					<tbody id="file-table" class="del_gro_fil">
					</tbody>
				</table>
				<div class="page">
					<ul class="pagination" id="file-page"></ul>
				</div>
			</div>
		</div>
		<!-- 讨论组文件 end -->
		<!-- 历史消息记录 start -->
		<div class="right-main-div" id="hi_msg_div" style="display: none; border: 2px solid green; height: 99.8%;">
			<div class="close_groupinfo_div" onclick="show_chat()">
				<i class="fa fa-close"></i>
			</div>
			<div id="hi-msg-content">
				<div style="margin: 20%; font-size: 18px; color: #999;">
					<span>没有历史消息</span>
				</div>
			</div>
			<div class="page">
				<ul class="pagination" id="msg-page"></ul>
			</div>
		</div>
		<!-- 历史消息记录 end -->
	</div>
</div>


<!-- 模态框（Modal） -->
<div class="modal fade" id="set_model" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel">工作空间配置</h4>
            </div>
            <div class="modal-body">
				<input type="button" style="margin-top: 10px;" value="工作空间" onclick="get_address()"/>：<input id="work_space" type="text" style="margin-left: 48px; height: 36px;"/>

				<div style="margin-top: 10px;">
					<lable class="col-sm-3" style="line-height:30px;">客户主页：</lable>
					<input type="text" id="c_page" style="line-height:30px;"/>
				</div>
				<div style="margin-top: 10px;">
					<lable class="col-sm-3" style="line-height:30px;">服务主页：</lable>
					<input type="text" id="s_page" style="line-height:30px;"/>
				</div>
			</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" onclick="commit_workspace()">提交</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- 模态框（Modal） -->
<div class="modal fade" id="my_Modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel">文件上传</h4>
			</div>
			<div class="modal-body" style="margin-left:65px;">

			  保密级别：<select id="level_Id" style="height: 35px;" onchange="isClick('true')"></select>

			</div>
			<div class="modal-footer">
				<div class="btn btn-default" id="update_btn" onclick="$(this).find('input')[0].click()" style="margin: 10px;">
					上传文件 <input type="file" style="display: none;" id="one" disabled="true"
						onchange="upload_chat_file(this)" multiple="multiple" />
				</div>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal -->
</div>
<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel">文件上传</h4>
			</div>
			<div class="modal-body" style="margin-left:65px;">

			  保密级别：<select id="levelId" style="height: 35px;" onchange="isClick('false')"></select>

			</div>
			<div class="modal-footer">
				<div class="btn btn-default" id="update_btn" onclick="$(this).find('input')[0].click()">
					上传文件 <input type="file" style="display: none;" id="two" disabled="true"
						onchange="upload_group_file(this)" multiple="multiple" />
				</div>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal -->
</div>
<!-- 模态框（Modal） -->
<div class="modal fade" id="sysInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel2">消息详情</h4>
			</div>
			<div class="modal-body" style="margin-left:65px;">
				<div id="show" style="margin: auto;"></div>
			</div>
		</div>
	</div>
</div>
<!-- 模态框（Modal） -->
<div class="modal fade" id="group-user-modal" tabindex="-1"
	role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<!-- 	<div class="modal-dialog"> -->
<!-- 		<div class="modal-content"> -->
			<div class="modal-body_">
				<!-- 弹窗内容 -->
				<div class="user-left_">
					<div id="guser_lastname" style="text-align: center; margin-top: 25%;"></div>
					<div id="guser-name" style="text-align: center; margin-top: 10px; font-weight: bold;"></div>
				</div>
				<div class="user-right_">
					<div class="rows" style="margin-top: 22px;">
						<i class="fa fa-sitemap"></i> ： <span id="guser-org"></span>
					</div>
					<div class="rows">
						<i class="fa fa-mobile" style="font-size: 27px;"></i> ： <span id="guser-mobile"></span>
					</div>
					<div class="rows">
						<i class="fa fa-phone"></i> ： <span id="guser-phone"></span>
					</div>
					<div class="rows">
						<i class="fa fa-envelope"></i> ： <span id="guser-email"></span>
					</div>
				</div>
			</div>
<!-- 		</div> -->
		<!-- /.modal-content -->
<!-- 	</div> -->
	<!-- /.modal-dialog -->
</div>

<script>
	// 激活文字提示
	$("[data-toggle='tooltip']").tooltip();

	layui.config({
		base: '../js/layui/lay/mymodules/'}
	);
	var orgdata = "";
	//注意：选项卡 依赖 element 模块，否则无法进行功能性操作
	$.ajax({
		type: 'post',
		url: '/homeController/getOrgDataByPid',
		data: {'pid': '0000'},
		async: false,
		cache: false,
		success: function (data) {
			console.log(data);
			orgdata = data;
		}
	});
	layui.use(['element','eleTree'], function() {
		var element = layui.element;

		var eleTree = layui.eleTree;


		$(".eleTree-search").on("change",function() {
			// el6.search($(this).val());
			if ($(this).val()){
				$.ajax({
					type : 'post',
					url : '/homeController/getOrgDataByUserName',
					data: {'noLogUser' : "true",
						'userName':$(this).val()},
					async:false,
					cache: false,
					success:function (res) {
						let eles=eleTree.render({
							elem: '.ele6',
							// data: data,
							// showCheckbox: true,
							defaultExpandAll: true,
							defaultCheckedKeys: [23,24],
							accordion: false
						});
						console.log(res);
						eles.reload({data:res});
					}
				});
			}else {
				showTree();
			}

		});

		showTree();
		// 节点点击事件
		eleTree.on("nodeClick(userList)",function(d) {
			console.log(d.data);    // 点击节点对应的数据
			// debugger
			if (d.data.currentData.children.length==0){
				change_chat(d.data.currentData.id,d.data.currentData.label,"user",this);
			}else {
				// console.log("23123")
			}

		});

		function showTree() {
			let el6=eleTree.render({
				elem: '.ele6',
				data: orgdata,
				// showCheckbox: true,
				defaultExpandAll: true,
				// defaultCheckedKeys: [23,24],
				// accordion: false,
				highlightCurrent:true,
				showLine:true,
				async:false,
				lazy: true,
				load: function(data,callback){
					console.log('jiazai')
					console.log(data);
					console.log(data.children.length);
					let newData;
					if (data.leaf == 0)
					{
						$.ajax({
							type : 'post',
							url : '/homeController/getOrgDataByPid',
							data: {'pid' : data.id},
							async:false,
							cache: false,
							success:function (res) {
								// console.log(res)
								newData =res
							}
						})
						// setTimeout(function() {

						// },500);
					}
					else {
						$.ajax({
							type : 'post',
							url : '/homeController/getUserDataByPid',
							data: {'pid' : data.id},
							async:false,
							cache: false,
							success:function (res) {
								// console.log(res)
								newData =res
							}
						})
					}

					callback(newData);
				},
				searchNodeMethod: function(value,data) {
					if (!value) return true;
					return data.label.indexOf(value) !== -1;
				}
			});
		}
	});
	// });

</script>